{% extends 'base.html' %}

{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/form.css' %}">
{% endblock %}

{% block content %}
<!-- ================= HERO CAROUSEL ================= -->
<section class="pt-24 relative overflow-hidden">
    <div id="carousel" class="relative h-[600px]">

        <!-- Slide 1 -->
        <div class="slide hero-slide-1 absolute inset-0 text-white flex items-center">
            <div class="max-w-7xl mx-auto px-4">
                <div class="max-w-2xl">
                    <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight font-serif">
                        Empowering Global Education
                    </h1>
                    <p class="mb-8 text-xl text-gray-200">World-class online education with flexibility and excellence.
                        Join students from 120+ countries.</p>
                    <div class="flex flex-wrap gap-4">
                        <button
                            class="bg-miu-accent text-miu-primary px-8 py-4 rounded-lg font-semibold text-lg hover:bg-yellow-400 transition-colors shadow-lg">
                            Apply Now
                        </button>
                        <button
                            class="border-2 border-white text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-white hover:text-miu-primary transition-colors">
                            Explore Programs
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 2 -->
        <div class="slide hero-slide-2 hidden absolute inset-0 text-white flex items-center">
            <div class="max-w-7xl mx-auto px-4">
                <div class="max-w-2xl">
                    <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight font-serif">
                        Learn From Anywhere
                    </h1>
                    <p class="mb-8 text-xl text-gray-200">Study at your pace with expert faculty and cutting-edge
                        digital platforms.</p>
                    <div class="flex flex-wrap gap-4">
                        <button
                            class="bg-white text-miu-secondary px-8 py-4 rounded-lg font-semibold text-lg hover:bg-gray-100 transition-colors shadow-lg">
                            Virtual Tour
                        </button>
                        <button
                            class="border-2 border-white text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-white hover:text-miu-secondary transition-colors">
                            Meet Our Faculty
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3 -->
        <div class="slide hero-slide-3 hidden absolute inset-0 text-white flex items-center">
            <div class="max-w-7xl mx-auto px-4">
                <div class="max-w-2xl">
                    <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight font-serif">
                        Build Your Future
                    </h1>
                    <p class="mb-8 text-xl text-gray-200">Career-focused programs designed for success in today's global
                        marketplace.</p>
                    <div class="flex flex-wrap gap-4">
                        <button
                            class="bg-miu-accent text-miu-primary px-8 py-4 rounded-lg font-semibold text-lg hover:bg-yellow-400 transition-colors shadow-lg">
                            View Careers
                        </button>
                        <button
                            class="border-2 border-white text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-white hover:text-miu-primary transition-colors">
                            Alumni Network
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Carousel Indicators -->
        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 flex space-x-3">
            <button
                class="carousel-indicator w-3 h-3 rounded-full bg-white opacity-50 hover:opacity-100 transition-opacity"
                data-index="0"></button>
            <button
                class="carousel-indicator w-3 h-3 rounded-full bg-white opacity-50 hover:opacity-100 transition-opacity"
                data-index="1"></button>
            <button
                class="carousel-indicator w-3 h-3 rounded-full bg-white opacity-50 hover:opacity-100 transition-opacity"
                data-index="2"></button>
        </div>
    </div>
</section>


<!-- ================= APPLICATION FORM ================= -->
<section id="contact" class="py-10 bg-gradient-light">
    <div class="max-w-7xl mx-auto px-4">
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-miu-primary mb-4 font-serif">Course Application Form</h1>
            <p class="text-gray-600 max-w-3xl mx-auto text-lg">Complete your application to Modern International
                University in 5 simple steps. Your progress will be saved automatically.</p>
        </div>

        <!-- Mobile Progress Indicator -->
        <div class="mobile-progress-indicator">
            <div class="flex justify-between items-center mb-2">
                <span class="font-medium text-gray-800">Step <span id="mobileCurrentStep">1</span> of 5</span>
                <span class="text-sm font-bold text-miu-primary" id="mobileProgressPercentage">20%</span>
            </div>
            <div class="progress-bar-container">
                <div id="mobileProgressBar" class="progress-bar-fill" style="width: 20%"></div>
            </div>
            <div class="text-center">
                <span id="mobileStepTitle" class="text-miu-primary font-medium">Personal Information</span>
            </div>
        </div>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Progress Side Menu -->
            <div class="progress-side-menu lg:w-1/4">
                <div class="bg-white rounded-xl shadow-lg p-6 sticky top-32">
                    <h3 class="font-bold text-xl mb-6 text-miu-primary border-b pb-3">Application Stages</h3>

                    <div class="space-y-2">
                        <!-- Step 1 -->
                        <div class="progress-step active flex items-start" data-step="1">
                            <div class="step-number mr-3">1</div>
                            <div>
                                <h4 class="font-bold text-gray-800">Personal Information</h4>
                                <p class="text-sm text-gray-500">Basic details & contact</p>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div class="progress-step flex items-start" data-step="2">
                            <div class="step-number mr-3">2</div>
                            <div>
                                <h4 class="font-bold text-gray-800">Academic History</h4>
                                <p class="text-sm text-gray-500">Education background</p>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div class="progress-step flex items-start" data-step="3">
                            <div class="step-number mr-3">3</div>
                            <div>
                                <h4 class="font-bold text-gray-800">Course Selection</h4>
                                <p class="text-sm text-gray-500">Program & preferences</p>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div class="progress-step flex items-start" data-step="4">
                            <div class="step-number mr-3">4</div>
                            <div>
                                <h4 class="font-bold text-gray-800">Documents</h4>
                                <p class="text-sm text-gray-500">Upload supporting files</p>
                            </div>
                        </div>

                        <!-- Step 5 -->
                        <div class="progress-step flex items-start" data-step="5">
                            <div class="step-number mr-3">5</div>
                            <div>
                                <h4 class="font-bold text-gray-800">Review & Submit</h4>
                                <p class="text-sm text-gray-500">Finalize application</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 pt-6 border-t">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-gray-600">Overall Progress</span>
                            <span class="text-sm font-bold text-miu-primary" id="progressPercentage">20%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div id="progressBar" class="progress-bar-fill" style="width: 20%"></div>
                        </div>

                        <div class="mt-6 text-center">
                            <button id="saveProgressBtn"
                                class="text-miu-secondary hover:text-miu-primary font-medium text-sm">
                                üíæ Save Progress & Continue Later
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Content -->
            <div class="form-content lg:w-3/4">
                <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                    <!-- Top Progress Bar -->
                    <div class="mb-8">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-medium text-gray-800">Step <span id="currentStep">1</span> of 5</span>
                            <span class="text-sm font-bold text-miu-primary" id="stepProgressPercentage">20%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div id="stepProgressBar" class="progress-bar-fill" style="width: 20%"></div>
                        </div>
                        <div class="mt-2">
                            <span id="stepTitle" class="text-miu-primary font-medium text-lg">Personal
                                Information</span>
                        </div>
                    </div>

                    <form id="applicationForm" method="POST" enctype="multipart/form-data" action="{% url 'apply' %}">
                        {% csrf_token %}

                        <!-- Hidden field to track current step -->
                        <input type="hidden" name="current_step" id="currentStepInput" value="1">

                        <!-- Step 1: Personal Information -->
                        <div class="form-step active" id="step1">
                            <h2 class="text-2xl font-bold text-miu-primary mb-2">Personal Information</h2>
                            <p class="text-gray-600 mb-6">Please provide your personal details and contact information.
                            </p>

                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">{{ form.first_name.label }}
                                        <span class="text-red-500">*</span></label>
                                    {{ form.first_name }}
                                    {% if form.first_name.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.first_name.errors.0 }}</p>
                                    {% endif %}
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">{{ form.last_name.label }} <span
                                            class="text-red-500">*</span></label>
                                    {{ form.last_name }}
                                    {% if form.last_name.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.last_name.errors.0 }}</p>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">{{ form.email.label }} <span
                                        class="text-red-500">*</span></label>
                                {{ form.email }}
                                {% if form.email.errors %}
                                <p class="text-red-500 text-sm mt-1">{{ form.email.errors.0 }}</p>
                                {% endif %}
                            </div>

                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">{{ form.phone.label }} <span
                                            class="text-red-500">*</span></label>
                                    {{ form.phone }}
                                    {% if form.phone.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.phone.errors.0 }}</p>
                                    {% endif %}
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">{{ form.date_of_birth.label }}
                                        <span class="text-red-500">*</span></label>
                                    {{ form.date_of_birth }}
                                    {% if form.date_of_birth.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.date_of_birth.errors.0 }}</p>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">{{ form.country.label }} <span
                                            class="text-red-500">*</span></label>
                                    {{ form.country }}
                                    {% if form.country.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.country.errors.0 }}</p>
                                    {% endif %}
                                </div>

                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">{{ form.gender.label }} <span
                                            class="text-red-500">*</span></label>
                                    {{ form.gender }}
                                    {% if form.gender.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.gender.errors.0 }}</p>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">{{ form.address.label }} <span
                                        class="text-red-500">*</span></label>
                                {{ form.address }}
                                {% if form.address.errors %}
                                <p class="text-red-500 text-sm mt-1">{{ form.address.errors.0 }}</p>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Step 2: Academic History - KEEP AS IS but update field names -->
                        <div class="form-step" id="step2">
                            <h2 class="text-2xl font-bold text-miu-primary mb-2">Academic History</h2>
                            <p class="text-gray-600 mb-6">Please provide details of your previous education. Click "Add
                                More" to include multiple academic entries.</p>

                            <!-- Academic Entries Container -->
                            <div id="academicEntriesContainer" class="mb-6">
                                <!-- Entries added by JavaScript -->
                            </div>

                            <div class="text-center mb-6">
                                <button type="button" id="addAcademicEntryBtn"
                                    class="border-2 border-dashed border-miu-secondary text-miu-secondary px-6 py-3 rounded-lg font-medium hover:bg-miu-secondary hover:text-white transition-all">
                                    + Add Another Academic Entry
                                </button>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">English Language Proficiency <span
                                        class="text-red-500">*</span></label>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <div class="flex items-center">
                                        <input type="radio" id="toefl" name="english_proficiency_type" value="toefl"
                                            class="mr-2">
                                        <label for="toefl">TOEFL</label>
                                        <input type="text" name="toefl_score" placeholder="Score"
                                            class="ml-2 p-2 border border-gray-300 rounded w-20">
                                    </div>
                                    <div class="flex items-center">
                                        <input type="radio" id="ielts" name="english_proficiency_type" value="ielts"
                                            class="mr-2">
                                        <label for="ielts">IELTS</label>
                                        <input type="text" name="ielts_score" placeholder="Score"
                                            class="ml-2 p-2 border border-gray-300 rounded w-20">
                                    </div>
                                    <div class="flex items-center">
                                        <input type="radio" id="other-test" name="english_proficiency_type"
                                            value="other" class="mr-2">
                                        <label for="other-test">Other</label>
                                        <input type="text" name="other_test" placeholder="Test name"
                                            class="ml-2 p-2 border border-gray-300 rounded w-32">
                                    </div>
                                    <div class="flex items-center">
                                        <input type="radio" id="native" name="english_proficiency_type" value="native"
                                            class="mr-2">
                                        <label for="native">Native Speaker</label>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">{{
                                    form.additional_qualifications.label }}</label>
                                {{ form.additional_qualifications }}
                            </div>
                        </div>

                        <!-- Step 3: Course Selection -->
                        <div class="form-step" id="step3">
                            <h2 class="text-2xl font-bold text-miu-primary mb-2">Course Selection</h2>
                            <p class="text-gray-600 mb-6">Select your preferred program and study options.</p>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">{{ form.program.label }} <span
                                        class="text-red-500">*</span></label>
                                {{ form.program }}
                                {% if form.program.errors %}
                                <p class="text-red-500 text-sm mt-1">{{ form.program.errors.0 }}</p>
                                {% endif %}
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">{{ form.degree_level.label }} <span
                                        class="text-red-500">*</span></label>
                                <div class="grid md:grid-cols-3 gap-4">
                                    {% for radio in form.degree_level %}
                                    <div
                                        class="flex items-center p-3 border border-gray-300 rounded-lg hover:border-miu-secondary cursor-pointer">
                                        {{ radio.tag }}
                                        <div class="ml-3">
                                            <label for="{{ radio.id_for_label }}" class="font-medium cursor-pointer">{{
                                                radio.choice_label }}</label>
                                            <p class="text-sm text-gray-500">
                                                {% if radio.choice_value == 'bachelor' %}Undergraduate degree
                                                {% elif radio.choice_value == 'master' %}Graduate degree
                                                {% else %}Research degree{% endif %}
                                            </p>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                {% if form.degree_level.errors %}
                                <p class="text-red-500 text-sm mt-1">{{ form.degree_level.errors.0 }}</p>
                                {% endif %}
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">{{ form.study_mode.label }} <span
                                        class="text-red-500">*</span></label>
                                <div class="grid md:grid-cols-2 gap-4">
                                    {% for radio in form.study_mode %}
                                    <div
                                        class="flex items-center p-3 border border-gray-300 rounded-lg hover:border-miu-secondary cursor-pointer">
                                        {{ radio.tag }}
                                        <div class="ml-3">
                                            <label for="{{ radio.id_for_label }}" class="font-medium cursor-pointer">{{
                                                radio.choice_label }}</label>
                                            <p class="text-sm text-gray-500">
                                                {% if radio.choice_value == 'full-time' %}On campus
                                                {% elif radio.choice_value == 'part-time' %}Flexible schedule
                                                {% elif radio.choice_value == 'online' %}Remote learning
                                                {% else %}Mix of online & on-campus{% endif %}
                                            </p>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                {% if form.study_mode.errors %}
                                <p class="text-red-500 text-sm mt-1">{{ form.study_mode.errors.0 }}</p>
                                {% endif %}
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">{{ form.intake.label }} <span
                                        class="text-red-500">*</span></label>
                                <div class="grid md:grid-cols-3 gap-4">
                                    {% for radio in form.intake %}
                                    <div
                                        class="flex items-center p-3 border border-gray-300 rounded-lg hover:border-miu-secondary cursor-pointer">
                                        {{ radio.tag }}
                                        <label for="{{ radio.id_for_label }}" class="font-medium cursor-pointer ml-3">{{
                                            radio.choice_label }}</label>
                                    </div>
                                    {% endfor %}
                                </div>
                                {% if form.intake.errors %}
                                <p class="text-red-500 text-sm mt-1">{{ form.intake.errors.0 }}</p>
                                {% endif %}
                            </div>

                            <div class="mb-6">
                                <div class="flex items-center">
                                    {{ form.scholarship }}
                                    <label for="{{ form.scholarship.id_for_label }}" class="font-medium ml-3">{{
                                        form.scholarship.label }}</label>
                                </div>
                                <p class="text-sm text-gray-500 mt-2">Check this box if you wish to be considered for
                                    merit-based scholarships and financial assistance programs.</p>
                            </div>
                        </div>

                        <!-- Step 4: Documents -->
                        <div class="form-step" id="step4">
                            <h2 class="text-2xl font-bold text-miu-primary mb-2">Supporting Documents</h2>
                            <p class="text-gray-600 mb-6">Upload your supporting documents. All files should be in PDF,
                                DOC, DOCX, JPG, or PNG format.</p>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">Academic Transcripts <span
                                        class="text-red-500">*</span></label>
                                <input type="file" name="transcripts_file" accept=".pdf,.doc,.docx,.jpg,.png"
                                    class="w-full p-3 border border-gray-300 rounded-lg">
                                <p class="text-sm text-gray-500 mt-1">Official transcripts from all previous
                                    institutions</p>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">Proof of English Proficiency</label>
                                <input type="file" name="english_proficiency_file" accept=".pdf,.doc,.docx,.jpg,.png"
                                    class="w-full p-3 border border-gray-300 rounded-lg">
                                <p class="text-sm text-gray-500 mt-1">TOEFL, IELTS, or equivalent test scores</p>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">Personal Statement <span
                                        class="text-red-500">*</span></label>
                                <input type="file" name="personal_statement_file" accept=".pdf,.doc,.docx"
                                    class="w-full p-3 border border-gray-300 rounded-lg">
                                <p class="text-sm text-gray-500 mt-1">Statement of purpose (500-1000 words)</p>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">Curriculum Vitae / Resume</label>
                                <input type="file" name="cv_file" accept=".pdf,.doc,.docx"
                                    class="w-full p-3 border border-gray-300 rounded-lg">
                                <p class="text-sm text-gray-500 mt-1">Detailed CV highlighting experience & achievements
                                </p>
                            </div>

                            <div class="mb-6">
                                <label class="block text-gray-700 mb-2 font-medium">Additional Documents
                                    (Optional)</label>
                                <input type="file" name="additional_files" accept=".pdf,.doc,.docx,.jpg,.png" multiple
                                    class="w-full p-3 border border-gray-300 rounded-lg">
                                <p class="text-sm text-gray-500 mt-1">You can select multiple files</p>
                            </div>
                        </div>

                        <!-- Step 5: Review & Submit -->
                        <div class="form-step" id="step5">
                            <h2 class="text-2xl font-bold text-miu-primary mb-2">Review & Submit</h2>
                            <p class="text-gray-600 mb-6">Please review your application details before submission.</p>

                            <div class="mb-8">
                                <div class="bg-blue-50 p-6 rounded-xl mb-6">
                                    <h3 class="font-bold text-lg mb-4 text-blue-800">Application Summary</h3>
                                    <div id="reviewSummary" class="text-sm text-gray-700">
                                        <!-- Summary will be populated by JavaScript -->
                                    </div>
                                </div>

                                <div class="mb-6">
                                    <label class="block text-gray-700 mb-2 font-medium">{{ form.referral_source.label
                                        }}</label>
                                    {{ form.referral_source }}
                                </div>

                                <div class="mb-6">
                                    <div class="flex items-start">{{ form.declaration }}
                                        <div class="ml-3">
                                            <label for="{{ form.declaration.id_for_label }}"
                                                class="font-medium">Declaration <span
                                                    class="text-red-500">*</span></label>
                                            <p class="text-sm text-gray-600 mt-1">I certify that the information
                                                provided in this application is true, complete, and accurate to the best
                                                of my knowledge.</p>
                                        </div>
                                    </div>
                                    {% if form.declaration.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.declaration.errors.0 }}</p>
                                    {% endif %}
                                </div>

                                <div class="mb-6">
                                    <div class="flex items-start">
                                        {{ form.privacy }}
                                        <div class="ml-3">
                                            <label for="{{ form.privacy.id_for_label }}" class="font-medium">Privacy
                                                Policy <span class="text-red-500">*</span></label>
                                            <p class="text-sm text-gray-600 mt-1">I have read and agree to the MIU
                                                Privacy Policy.</p>
                                        </div>
                                    </div>
                                    {% if form.privacy.errors %}
                                    <p class="text-red-500 text-sm mt-1">{{ form.privacy.errors.0 }}</p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Display form-level errors -->
                        {% if form.non_field_errors %}
                        <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                            <ul class="list-disc list-inside text-red-700">
                                {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}

                        <!-- Navigation Buttons -->
                        <div class="flex justify-between pt-8 border-t mt-8">
                            <button type="button" id="prevBtn"
                                class="border-2 border-gray-300 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-50 transition-all hidden">
                                ‚Üê Previous Step
                            </button>

                            <button type="button" id="nextBtn"
                                class="bg-gradient-miu text-white px-8 py-3 rounded-lg font-semibold hover:opacity-90 transition-all shadow-lg ml-auto">
                                Next Step ‚Üí
                            </button>

                            <button type="submit" id="submitBtn"
                                class="bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition-all shadow-lg hidden">
                                Submit Application
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- <script src="{% static 'js/form.js' %}"></script> -->

{% endblock %}